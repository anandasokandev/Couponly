<c-col xs="12">
  <c-card class="mb-4">
    <c-card-header class="d-flex align-items-center">
      <strong class="w-100 fs-5">Promotions History</strong>
      <div class="d-grid gap-4 d-sm-flex justify-content-md-end w-100">
        <div class="float-end d-flex gap-2">
          <button class="btn btn-primary btn-sm" (click)="navigateToNewPromotion()">
          <svg [cIcon]="icons.cilPenNib" class="me-2"></svg>
          New Promotion
        </button>
          <button class="btn btn-primary btn-sm px-3 py-1 text-nowrap d-flex align-items-center"
                        (click)="downloadsExcel()">
                        <svg [cIcon]="icons.cilCloudDownload"></svg> &nbsp; Download
                    </button>
        </div>
      </div>
    </c-card-header>

    <c-card-body>
      <form>
        <div class="d-flex flex-wrap justify-content-start py-3">
          <div class="d-flex gap-4 align-items-center m-2">
            <select class="form-select form-select-sm" style="max-width: 180px;" [(ngModel)]="searchType"
              (change)="fetchPromotions()" name="searchType">
              <option value="6">All</option>
              <option value="1">Campaign Title</option>
              <option value="2">Coupon Name</option>
              <option value="5">Coupon Code</option>
              <option value="3">Recipients Sent</option>
              <option value="4">Amount</option>
            </select>

            <input type="text" class="form-control form-control-sm" style="max-width: 280px"
              name="searchText" placeholder="🔍 Search By..." [(ngModel)]="searchText"
              (input)="fetchPromotions()" />
          </div>

          <div class="input-container d-flex gap-1 align-items-center m-2">
            <label for="fromDate" class="input-label">From:</label>
            <input [(ngModel)]="fromDate" name="fromDate" type="date" id="fromDate"
              class="form-control form-control-sm" (change)="fetchPromotions()" />
          </div>
          <div class="input-container d-flex gap-1 align-items-center m-1">
            <label for="toDate" class="input-label">To:</label>
            <input [(ngModel)]="toDate" name="toDate" type="date" id="toDate"
              class="form-control form-control-sm" (change)="fetchPromotions()" />
          </div>

          <button class="btn btn-sm btn-danger text-white m-2" title="Reset" (click)="resetFilters()">
            <i class="fas fa-arrows-rotate"></i>
          </button>
        </div>
      </form>

      <div *ngIf="isLoading" class="d-flex justify-content-center my-5">
        <div class="spinner-border text-primary" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
      </div>

      <div *ngIf="!isLoading" class="table-responsive">
        <table cTable class="responsive-table">
          <thead>
            <tr>
              <th>#</th>
              <th>Campaign Title</th>
              <th>Coupon Name</th>
              <th>Coupon Code</th>
               <th>Recipients Sent</th>
              <th>Amount</th>
              <th>Sent Date</th>
              <th>Invoice</th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngIf="promotions.length > 0; else noData">
              <tr *ngFor="let promo of promotions; let i = index">
                <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
                <td>{{ promo.campaignName }}</td>
                <td>{{ promo.couponName }}</td>
                <td>{{ promo.couponCode }}</td>
                <td>{{ promo.contacts }}</td>
                <td>{{ promo.amount }}</td>
                <td>{{ promo.date | date: 'yyyy-MM-dd' }}</td>
                <td>
                  <button class="btn btn-primary btn-sm px-3 py-1 text-nowrap d-flex align-items-center">
                    <svg [cIcon]="icons.cilCloudDownload"></svg> &nbsp; Invoice
                  </button>
                </td>
              </tr>
            </ng-container>
            <ng-template #noData>
              <tr>
                <td colspan="6" class="text-center text-muted py-4">
                  <i class="fas fa-info-circle me-2"></i> No data found
                </td>
              </tr>
            </ng-template>
          </tbody>
        </table>
      </div>

      <app-pagination *ngIf="!isLoading" [totalItems]="totalItems" [itemsPerPage]="itemsPerPage"
        [currentPage]="currentPage" (pageChange)="onPageChange($event)"
        (itemsPerPageChange)="itemsPerPage = $event; onPageChange(1)">
      </app-pagination>
    </c-card-body>
  </c-card>
</c-col>
