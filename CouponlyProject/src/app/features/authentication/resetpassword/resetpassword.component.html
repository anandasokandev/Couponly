<div class="coupon-login-container">
  <div class="coupon-card">

    <!-- LEFT DESIGN -->
    <div class="coupon-left">
      <img src="assets/logo.png" style="width: 200px;" alt="Logo" />
      <h2>Welcome Back!</h2>
      <p>Use your credentials to sign in and unlock your coupon benefits.</p>
    </div>

    <!-- RIGHT SIDE WITH YOUR ORIGINAL FORM -->
    <div class="coupon-right">

      <div class="perforated-line"></div>
      <div class="scissors-icon">&#xf0c4;</div>

      <div class="mb-3 position-relative">
        <form (ngSubmit)="onSubmit()" #resetForm="ngForm">
          <h2 class="mb-3 text-center fw-bold">Reset Password</h2>
          <p class="text-muted text-center mb-4">Set your new password</p>
        
          <div *ngIf="message" class="message" [class.form-success]="!isError" [class.form-error]="isError">
            {{ message }}
          </div>

          <div class="mb-2 position-relative">
            <label for="newPassword" class="form-label my-1">
              New Password <span class="text-danger">*</span>
            </label>
              <!-- <span class="input-group-text">
                <i class="fa fa-key mx-2"></i>
              </span> -->
              <input [type]="showPassword ? 'text' : 'password'"
                      id="newPassword"
                      class="form-control pe-5"
                      placeholder="Enter new password"
                      [(ngModel)]="newPassword"
                      name="newPassword"
                      (ngModelChange)="updatePasswordStrength(newPassword)"
                      required>
                      
            <i *ngIf="showPassword"
              class="fa-solid fa-eye top-50 position-absolute end-0 translate-middle-y me-3 mt-3 text-muted"
              style="cursor:pointer;"
              (click)="showPassword = !showPassword"></i>

            <i *ngIf="!showPassword"
              class="fa-solid fa-eye-slash top-50 position-absolute end-0 translate-middle-y me-3 mt-3 text-muted"
              style="cursor:pointer;"
              (click)="showPassword = !showPassword"></i>
          </div>
          <div class="my-2 px-2" *ngIf="newPassword">
              <div class="progress" style="height:6px;">
                  <div
                      class="progress-bar"
                      [ngClass]="{
                        'bg-danger': passwordStrength < 30,
                        'bg-warning': passwordStrength >= 30 && passwordStrength < 70,
                        'bg-success': passwordStrength >= 70
                      }"
                      role="progressbar"
                      [style.width.%]="passwordStrength"
                      aria-valuemin="0"
                      aria-valuemax="100"
                  ></div>
              </div>
              <small class="text-muted">{{ passwordStrengthLabel }}</small>
          </div>

          <!-- Confirm New Password -->
          <div class="mb-4 position-relative">
            <label for="confirmPassword" class="form-label my-1">
              Confirm New Password <span class="text-danger">*</span>
            </label>
              <!-- <span class="input-group-text">
                <i class="fa fa-key mx-2"></i>
              </span> -->
            <input [type]="showRePassword ? 'text' : 'password'" id="confirmPassword" class="form-control pe-5" placeholder="Confirm new password" [(ngModel)]="confirmPassword" name="confirmPassword" required>
            
            <i *ngIf="showRePassword"
              class="fa-solid fa-eye top-50 position-absolute end-0 translate-middle-y me-3 mt-3 text-muted"
              style="cursor:pointer;"
              (click)="showRePassword = !showRePassword"></i>

            <i *ngIf="!showRePassword"
              class="fa-solid fa-eye-slash top-50 position-absolute end-0 translate-middle-y me-3 mt-3 text-muted"
              style="cursor:pointer;"
              (click)="showRePassword = !showRePassword"></i>
          </div>

          <div class="text-center mb-3">
            <button 
              type="submit" 
              class="btn-coupon d-flex align-items-center justify-content-center" 
              [disabled]="resetForm.invalid || isLoading">

              <c-spinner *ngIf="isLoading" class="me-2" size="sm"></c-spinner>
              <span *ngIf="isLoading">Updating...</span>
              <span *ngIf="!isLoading">Update Password</span>
            </button>
          </div>

          <p class="text-center text-muted mb-0">
            Remembered your password?
            <a href="/login" class="text-decoration-none">Go back to login</a>
          </p>
        </form>
      </div>
    </div>
  </div>
</div>