<c-col xs="12">
  <c-card class="mb-4">
    <c-card-header class="d-flex justify-content-between align-items-center">
      <strong class="fs-5">
        {{ isViewingCoupons ? 'Coupons for ' + selectedStore?.name : 'Store-Wise Coupons' }}
      </strong>
      <button *ngIf="isViewingCoupons" class="btn btn-sm btn-primary" (click)="goBackToStores()">
        ‚Üê Back to Stores List
      </button>
    </c-card-header>
  <c-card-body>

  <!-- üîÅ Store List View -->
  <div *ngIf="!isViewingCoupons">
    <!-- üîç Store Filters -->
    <div class="d-flex justify-content-start align-items-center mb-4 flex-wrap gap-2">
    <select class="form-select form-select-sm" style="max-width: 160px;" [(ngModel)]="selectedStoreType"
    (change)="loadStoresByName()">
    <option [ngValue]="0">All Stores</option>
    <option [ngValue]="1">Online</option>
    <option [ngValue]="2">Offline</option>
  </select>
      <input type="text" class="form-control form-control-sm" style="max-width: 210px"
        [(ngModel)]="storeSearch" placeholder="Search Store Name" (input)="loadStoresByName()" />
      <button type="button" class="btn btn-danger btn-sm text-white" title="Reset" (click)="resetFilters()">
        <i class="fas fa-arrows-rotate"></i>
      </button>
    </div>

    <!-- üè¨ Store Cards Grid -->
    <div class="store-grid">
      <div *ngFor="let store of stores; let i = index" class="store-card">
        <div class="store-header">
          <img [src]="store.storeLogo" alt="{{ store.store }}" class="store-logo" />
          <div>
            <h5 class="store-name">{{ store.store }}</h5>
            <p class="store-category">{{ store.category }} ‚Ä¢ {{ store.type }}</p>
          </div>
        </div>
        <div class="store-body">
          <p><strong>Code:</strong> {{ store.code }}</p>
          <p><strong>Contact:</strong> {{ store.contact }}</p>
          <p><strong>Total Coupons:</strong> {{ store.totalCoupons || 0 }}</p>
        </div>
        <div class="store-footer">
          <button class="btn btn-sm btn-outline-primary w-100" (click)="viewCoupons(store)">
            View Coupons
          </button>
        </div>
      </div>
    </div>

    <!-- No Stores Found -->
    <div *ngIf="!isLoading && stores.length === 0" class="text-center mt-4">
      No stores found.
    </div>

    <!-- Pagination -->
    <app-pagination *ngIf="!isLoading" [totalItems]="totalItems" [itemsPerPage]="itemsPerPage"
      [currentPage]="currentPage" (pageChange)="onPageChange($event)"
      (itemsPerPageChange)="onItemsPerPageChange($event)">
    </app-pagination>
  </div>

  <!-- üéüÔ∏è Coupon List View -->
  <div *ngIf="isViewingCoupons">
    <div class="d-flex justify-content-start align-items-center mb-4 flex-wrap gap-2">
      <input type="text" class="form-control form-control-sm" style="max-width: 210px"
        [(ngModel)]="couponCodeSearch" placeholder="Search Coupon Code" (input)="filterStoreCoupons()" />
      <select class="form-select form-select-sm" style="max-width: 210px" [(ngModel)]="selectedTypeId"
        (change)="filterStoreCoupons()">
        <option [ngValue]="undefined">-- Select Type --</option>
        <option *ngFor="let type of types" [ngValue]="type.id">{{ type.name }}</option>
      </select>
      <select class="form-select form-select-sm" style="max-width: 180px;" [(ngModel)]="selectedDateFilter"
        (change)="filterStoreCoupons()">
        <option value="1">All Coupons</option>
        <option value="2">Valid Coupons</option>
        <option value="3">Upcoming Coupons</option>
        <option value="4">Expired Coupons</option>
      </select>
      <button type="button" class="btn btn-danger btn-sm text-white" title="Reset"
        (click)="resetStoreCouponFilters()">
        <i class="fas fa-arrows-rotate"></i>
      </button>
    </div>

    <div *ngIf="filteredCoupons.length === 0" class="text-center mb-4">
      No coupons found.
    </div>

    <div *ngIf="filteredCoupons.length > 0" class="coupon-grid">
      <div *ngFor="let coupon of filteredCoupons; let i = index" class="coupon-card">
        <img *ngIf="coupon.couponImage" [src]="coupon.couponImage" alt="Coupon Image" class="coupon-image" />
        <div class="coupon-content">
          <h5 class="coupon-title" [style.color]="getColor(i)">{{ coupon.name }}</h5>
          <div class="coupon-code-box">{{ coupon.couponCode }}</div>
          <p class="coupon-desc">{{ coupon.description }}</p>
          <div class="coupon-details">
            <p><strong>Store:</strong> {{ selectedStore.name }}</p>
            <p><strong>Type:</strong> {{ coupon.typeName }}</p>
            <p><strong>Min Amount:</strong> {{ coupon.minAmount | currency: 'INR' }}</p>
            <p><strong>User Limit:</strong> {{ coupon.userLimit === false ? 'Unlimited' : coupon.userLimitCount }}</p>
          </div>
          <div class="coupon-dates">
            <span>Start: {{ coupon.startingDate | date: 'dd-MM-yyyy' }}</span>
            <span>End: {{ coupon.endingDate | date: 'dd-MM-yyyy' }}</span>
          </div>
        </div>
      </div>
    </div>
  </div>

</c-card-body>

  </c-card>
</c-col>