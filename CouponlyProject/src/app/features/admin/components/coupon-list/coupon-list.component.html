<!--  Coupon List Section -->
<c-col xs="12">
  <c-card class="mb-4">
    <c-card-header class="d-flex justify-content-between align-items-center">
      <strong class="fs-5">Coupon List</strong>
    </c-card-header>

    <c-card-body>
      <!-- ðŸ” Search Filters -->
      <div class="d-flex justify-content-start align-items-center mb-4 flex-wrap gap-2">
        <!-- Coupon Code (text search) -->
        <input type="text"
               class="form-control form-control-sm"
               style="max-width: 210px"
               [(ngModel)]="couponCode"
               placeholder="Search Coupon Code"
               (input)="filterCoupons()" />

        <!-- Store Name Search -->
        <input type="text"
               class="form-control form-control-sm"
               style="max-width: 210px"
               [(ngModel)]="storeNameSearch"
               placeholder="Search Store Name"
               (input)="filterCoupons()" />

       <!-- Type Dropdown (Coupon Type Filter) -->
<select class="form-select form-select-sm" style="max-width: 210px"
        [(ngModel)]="selectedType" (change)="filterCoupons()">
  <option [ngValue]="undefined">-- Select Type --</option> <!-- Default placeholder -->
  <option *ngFor="let type of types" [ngValue]="type.id">{{ type.name }}</option>
</select>

        <!-- Reset Button -->
        <button type="button" class="btn btn-danger btn-sm text-white" title="Reset" (click)="resetFilters()">
          <i class="fas fa-arrows-rotate"></i>
        </button>
      </div>

      <!-- Loader -->
      <div *ngIf="isLoading">Loading...</div>

      <div *ngIf="!isLoading && coupons.length === 0">
        No coupons found.
      </div>

      <!-- Coupon Table -->
      <div *ngIf="!isLoading" class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Image</th>
              <th scope="col">Coupon Code</th>
              <th scope="col">Name</th>
              <th scope="col">Store</th>
              <th scope="col">Type</th> <!-- Added Type column -->
              <!-- <th scope="col">Category</th> -->
              <th scope="col">Description</th>
              <th scope="col">Min Amount</th>
              <th scope="col">User Limit Count</th> 
              <th scope="col">Start Date</th>
              <th scope="col">End Date</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let coupon of coupons; let i = index">
              <td>{{ ((currentPage - 1) * itemsPerPage) + (i + 1) }}</td>
              <td>
                <img *ngIf="coupon.couponImage" [src]="coupon.couponImage" alt="Coupon Image"
                     width="50" height="50" class="rounded"/>
              </td>
              <td>{{ coupon.couponCode }}</td>
              <td>{{ coupon.name }}</td>
              <td>{{ coupon.storeName }}</td>
              <td>{{ coupon.typeName }}</td> <!-- Added TypeName display -->
              <!-- <td>{{ coupon.categoryName }}</td> -->
              <td>{{ coupon.description }}</td>
              <td>{{ coupon.minAmount | currency:'INR' }}</td>
              <td>{{ coupon.userLimitCount > 0 ? coupon.userLimitCount : 'Unlimited' }}</td> 
              <td>{{ coupon.startingDate | date }}</td>
              <td>{{ coupon.endingDate | date }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <app-pagination
        *ngIf="!isLoading"
        [totalItems]="totalItems"
        [itemsPerPage]="itemsPerPage"
        [currentPage]="currentPage"
        (pageChange)="onPageChange($event)"
        (itemsPerPageChange)="onItemsPerPageChange($event)">
      </app-pagination>
    </c-card-body>
  </c-card>
</c-col>
