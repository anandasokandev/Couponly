<div class="row">
  <div class="col-lg-8 mb-4">
    <c-card>
      <c-card-header>
        <strong>Service Cost Settings</strong>
      </c-card-header>
      <c-card-body>
        <p class="text-body-secondary small">
          Set cost for each messaging and communication service. These costs are typically applied on a per-unit basis.
        </p>

        <div *ngIf="isLoading" class="text-center p-5">
          <c-spinner color="primary"></c-spinner>
          <p class="mt-2">Loading settings...</p>
        </div>

        <form *ngIf="!isLoading" #serviceCostForm="ngForm">
          <c-alert color="success" *ngIf="showSuccessMessage" dismissible (visibleChange)="showSuccessMessage = $event">
            <strong>Success!</strong> Costs have been updated.
          </c-alert>

          <div *ngFor="let service of serviceCosts" class="mb-3">
            <label [for]="service.id" class="form-label">{{ service.name }}</label>
            <c-input-group>
              <span cInputGroupText>
                <i [class]="service.icon"></i>
              </span>
              <span cInputGroupText><i class="fa-solid fa-indian-rupee-sign"></i></span>
              <input
                cFormControl
                type="number"
                step="0.001"
                [id]="service.id"
                [name]="service.id"
                [(ngModel)]="service.cost"
                [disabled]="service.isUpdating"
                required
              />
              <button cButton color="primary" type="button" (click)="updateServiceCost(service)" [disabled]="service.isUpdating" class="btn-sm">
                <c-spinner *ngIf="service.isUpdating" size="sm" aria-hidden="true"></c-spinner>
                <span *ngIf="!service.isUpdating">Update</span>
                <span *ngIf="service.isUpdating" class="ms-1">Updating...</span>
              </button>
            </c-input-group>
          </div>
        </form>
      </c-card-body>
    </c-card>
  </div>

  <div class="col-lg-4 mb-4">
    <c-card style="height: 100%;">
      <c-card-header>
        <strong>Handling Fee</strong>
      </c-card-header>
      <c-card-body>
        <p class="text-body-secondary small">
          Define a fixed fee that is applied to transactions or services.
        </p>

        <div *ngIf="isLoading" class="text-center p-5">
          <c-spinner color="primary"></c-spinner>
        </div>
        
        <form *ngIf="!isLoading" #feeForm="ngForm" (ngSubmit)="updateHandlingFee()">
          <div>
            <label for="handlingFee" class="form-label">Fee Amount</label>
            <c-input-group>
              <span cInputGroupText>
                <i class="fa-solid fa-indian-rupee-sign"></i>
              </span>
              <input
                cFormControl
                type="number"
                step="0.01"
                id="handlingFee"
                name="handlingFee"
                [(ngModel)]="handlingFee"
                [disabled]="isFeeUpdating"
                required
              />
            </c-input-group>
          </div>
        </form>
      </c-card-body>
      <c-card-footer *ngIf="!isLoading">
        <button
          cButton
          color="primary"
          (click)="updateHandlingFee()"
          [disabled]="isFeeUpdating"
          class="float-end btn-sm"
        >
          <c-spinner *ngIf="isFeeUpdating" size="sm" aria-hidden="true"></c-spinner>
          <span *ngIf="!isFeeUpdating">Update Fee</span>
          <span *ngIf="isFeeUpdating" class="ms-1">Updating...</span>
        </button>
      </c-card-footer>
    </c-card>
  </div>
</div>